C51 COMPILER V9.52.0.0   UART1                                                             05/02/2018 15:14:37 PAGE 1   


C51 COMPILER V9.52.0.0, COMPILATION OF MODULE UART1
OBJECT MODULE PLACED IN .\Obj\UART1.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE Application\Source\UART1.c LARGE BROWSE INCDIR(.\Application\Header) DEB
                    -UG OBJECTEXTEND PRINT(.\Lis\UART1.lst) TABS(2) OBJECT(.\Obj\UART1.obj)

line level    source

   1          #include "stc15f2k60s2.h"
   2          #define TBAUD (65536-FOSC/4/BAUD)
   3          #define FOSC 18432000L
   4          #define BAUD 115200
   5          bit busy;
   6          
   7          
   8          void Uart() interrupt 4 using 1
   9          {
  10   1        if(RI) 
  11   1        {
  12   2          RI=0;
  13   2        }
  14   1        if(TI)
  15   1        {
  16   2          TI=0;
  17   2          busy=0;
  18   2        }
  19   1      }
  20          void initUART1(void)
  21          {
  22   1        SCON=0x50; //0101 0000 8-bit uart,  baud rate variable
  23   1        AUXR |=0x95;//10010101 Timer2 as Baud Rate generator
  24   1        T2L=TBAUD;
  25   1        T2H=TBAUD>>8; 
  26   1        ES=1;           // enable uart1 interrupt
  27   1        EA=1;           // each interrupt source will be enable or disable by setting its interrupt bit
  28   1        PS=0;           // Serial Port 1 interrupt priority control bit, DS page 561
  29   1      }
  30          
  31          void SendUART1(unsigned char dat)
  32          {
  33   1        while(busy);
  34   1        busy=1;
  35   1        ACC=dat;
  36   1        SBUF=ACC;
  37   1      }
  38          
  39          
  40          
  41           void SendString(char *s)
  42          {
  43   1        while(*s)
  44   1        {
  45   2          SendUART1(*s++);
  46   2        }
  47   1      }
  48          unsigned char ten(unsigned char BCD)
  49          {
  50   1        return (BCD)>>4;
  51   1      }
  52          unsigned char unit(unsigned char BCD)
  53          {
  54   1      
C51 COMPILER V9.52.0.0   UART1                                                             05/02/2018 15:14:37 PAGE 2   

  55   1        //unit=BCD&0x0f;
  56   1        //dec=ten*10+unit;
  57   1        return BCD&0x0f;
  58   1      }
  59          unsigned char DectoBCD(unsigned char dec)
  60          {
  61   1      /*  unsigned char ten,unit;
  62   1        ten=BCD>>4;
  63   1        unit=BCD&0x0f;
  64   1        //dec=ten*10+unit;
  65   1        return ten*10+unit;*/
  66   1        return dec;
  67   1      }
  68          //if dat=1, we need to use ASCII value to display "1" on UART1
  69          unsigned char ASCII_Letter(unsigned char dat)
  70          {
  71   1        return dat+48;
  72   1      }
  73          
  74           


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    109    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----       3
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
