C51 COMPILER V9.52.0.0   BIPOLARMOTOR                                                      07/12/2018 15:55:40 PAGE 1   


C51 COMPILER V9.52.0.0, COMPILATION OF MODULE BIPOLARMOTOR
OBJECT MODULE PLACED IN .\Obj\BipolarMotor.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE BipolarMotor.c LARGE BROWSE INCDIR(.\Application\Header) DEBUG OBJECTEXT
                    -END PRINT(.\Lis\BipolarMotor.lst) TABS(2) OBJECT(.\Obj\BipolarMotor.obj)

line level    source

   1          #include "stc15f2k60s2.h"
   2          #include "LCD_Driver_SPLC780D.h"
   3          #include "Receiver_Position_Data.h"
   4          #include "math.h"
   5          //#include "PCF85963BTL.h"
   6          void Delay_ms(unsigned int ms);
   7          int Day_Of_Year(unsigned char months,unsigned char days);
   8          unsigned char BCDtoDec1(char bcd);
   9          float degree;
  10          
  11          unsigned char BCDtoDec1(unsigned char bcd)
  12          {
  13   1        unsigned char hi,lo;
  14   1        hi=bcd>>4;
  15   1        lo=bcd&0x0F;
  16   1        return hi*10+lo;
  17   1      }
  18          
  19          
  20          
  21          
  22          
  23          void Step_move(unsigned int step, bit dir)
  24          {
  25   1            unsigned int i=0;
  26   1            if(dir)
  27   1              P4 |=(1<<2);// set bit P4.2
  28   1            else
  29   1              P4 &=~(1<<2);// clear bit P4.2
  30   1            
  31   1            for( i=0;i<step;i++)
  32   1            {
  33   2                P4 |=1<<1;// P41=1 // moving distance (mm)=pi^2*step*4/675
  34   2                Wait_ms(2);
  35   2                P4 &= ~(1<<1);
  36   2                Wait_ms(2);
  37   2            }
  38   1      }
  39          
  40          void Move(float distance, bit direction)
  41          {
  42   1          unsigned int step;
  43   1          step= distance*375/(3.14159);
  44   1          Step_move(step,direction);
  45   1      }
  46          
  47          
  48          
  49          
  50          void Update_position(unsigned char mnths,unsigned char dys,unsigned char hurs,unsigned char mns,unsigned c
             -har sconds,int *currnt_pos)
  51          {
  52   1        int date,i;
  53   1        int desired_distance,distance;
C51 COMPILER V9.52.0.0   BIPOLARMOTOR                                                      07/12/2018 15:55:40 PAGE 2   

  54   1        /*hurs=0x12;
  55   1        mns=0x30;*/
  56   1        //sconds=0x15;
  57   1        date=Day_Of_Year(mnths,dys);
  58   1        //date=80;
  59   1        for(i=0;i<47;i++)// time stamp from 12PM to 15PM, 47 diff values of time stamp
  60   1        {
  61   2          if (BCDtoDec1(hurs)==Time_stamp_PM[i][0] && BCDtoDec1(mns)== Time_stamp_PM[i][1] && BCDtoDec1(sconds&0x7
             -f)==Time_stamp_PM[i][2])// check if current time match the time stamp in the table
  62   2          {     
  63   3            switch(date)
  64   3            {
  65   4              case 79:
  66   4                desired_distance=receiver_pos[i][0];
  67   4                break;
  68   4              case 80:
  69   4                desired_distance=receiver_pos[i][1];
  70   4                break;
  71   4              case 81:
  72   4                desired_distance=receiver_pos[i][2];
  73   4                break;
  74   4              case 82:
  75   4                desired_distance=receiver_pos[i][3];
  76   4                break;
  77   4              case 83:
  78   4                desired_distance=receiver_pos[i][4];
  79   4                break;
  80   4            }
  81   3            //desired_distance=receiver_pos[0][4];;
  82   3            //distance=11;
  83   3            distance=desired_distance-*currnt_pos;
  84   3            *currnt_pos=desired_distance;
  85   3            if(distance>0)
  86   3            {
  87   4              Move(abs(distance),1);
  88   4            }
  89   3            else if(distance<0)
  90   3            {
  91   4              Move(abs(distance),0);
  92   4            }
  93   3            
  94   3            break;
  95   3          }
  96   2        }
  97   1      }
  98          
  99          //int Day_Of_Year(unsigned char months,unsigned char days)*/


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    524    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =    615      24
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----       2
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
